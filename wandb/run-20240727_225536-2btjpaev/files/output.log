/usr/local/lib/python3.10/dist-packages/torch/_utils.py:835: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/usr/local/lib/python3.10/dist-packages/transformers/training_args.py:1494: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/cuda/__init__.py:565: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
[34m[1mwandb[39m[22m: [33mWARNING[39m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
Loaded 1736 valid polymer-protein pairs
Loaded 218 valid polymer-protein pairs


  1%|▌                                                                                                                 | 11/2170 [00:06<19:46,  1.82it/s]



  1%|█▏                                                                                                                | 23/2170 [00:12<19:17,  1.86it/s]


  1%|█▌                                                                                                                | 30/2170 [00:16<19:57,  1.79it/s]



  2%|██                                                                                                                | 40/2170 [00:22<20:40,  1.72it/s]



  2%|██▋                                                                                                               | 50/2170 [00:28<20:11,  1.75it/s]



  3%|███▏                                                                                                              | 61/2170 [00:34<19:35,  1.79it/s]



  3%|███▋                                                                                                              | 71/2170 [00:40<21:35,  1.62it/s]



  4%|████▏                                                                                                             | 80/2170 [00:46<23:02,  1.51it/s]




  4%|████▊                                                                                                             | 92/2170 [00:54<23:51,  1.45it/s]


  5%|█████▏                                                                                                           | 100/2170 [00:59<22:20,  1.54it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████                             | 21/28 [00:00<00:00, 21.74it/s]

{'loss': 0.606, 'grad_norm': 1.2005335092544556, 'learning_rate': 1e-05, 'epoch': 0.46}



  5%|█████▊                                                                                                           | 112/2170 [01:09<22:41,  1.51it/s]



  6%|██████▎                                                                                                          | 121/2170 [01:14<19:57,  1.71it/s]



  6%|██████▊                                                                                                          | 132/2170 [01:20<18:51,  1.80it/s]



  7%|███████▍                                                                                                         | 143/2170 [01:26<18:44,  1.80it/s]


  7%|███████▊                                                                                                         | 150/2170 [01:30<18:28,  1.82it/s]



  7%|████████▎                                                                                                        | 160/2170 [01:37<20:36,  1.63it/s]



  8%|████████▊                                                                                                        | 170/2170 [01:43<20:30,  1.63it/s]



  8%|█████████▎                                                                                                       | 179/2170 [01:49<21:32,  1.54it/s]



  9%|█████████▊                                                                                                       | 189/2170 [01:55<20:16,  1.63it/s]



  9%|██████████▎                                                                                                      | 199/2170 [02:01<18:42,  1.76it/s]
{'loss': 0.1209, 'grad_norm': 0.7571019530296326, 'learning_rate': 2e-05, 'epoch': 0.92}



 10%|██████████▊                                                                                                      | 208/2170 [02:07<19:01,  1.72it/s]



 10%|███████████▍                                                                                                     | 219/2170 [02:13<17:51,  1.82it/s]



 11%|███████████▉                                                                                                     | 230/2170 [02:19<18:13,  1.77it/s]


 11%|████████████▎                                                                                                    | 237/2170 [02:23<18:15,  1.76it/s]



 11%|████████████▊                                                                                                    | 247/2170 [02:29<18:06,  1.77it/s]



 12%|█████████████▍                                                                                                   | 258/2170 [02:35<17:54,  1.78it/s]



 12%|██████████████                                                                                                   | 269/2170 [02:41<17:40,  1.79it/s]



 13%|██████████████▌                                                                                                  | 279/2170 [02:47<17:45,  1.78it/s]


 13%|██████████████▉                                                                                                  | 286/2170 [02:51<17:34,  1.79it/s]



 14%|███████████████▍                                                                                                 | 297/2170 [02:57<17:30,  1.78it/s]
 14%|███████████████▌                                                                                                 | 300/2170 [02:58<17:36,  1.77it/s]

 75%|███████████████████████████████████████████████████████████████████████████████████████                             | 21/28 [00:02<00:00,  8.16it/s]



 14%|████████████████                                                                                                 | 309/2170 [03:07<19:29,  1.59it/s]



 15%|████████████████▌                                                                                                | 318/2170 [03:13<19:33,  1.58it/s]



 15%|█████████████████                                                                                                | 327/2170 [03:19<19:37,  1.56it/s]




 16%|█████████████████▋                                                                                               | 340/2170 [03:27<19:12,  1.59it/s]


 16%|██████████████████                                                                                               | 347/2170 [03:31<17:24,  1.75it/s]



 16%|██████████████████▋                                                                                              | 358/2170 [03:37<16:49,  1.80it/s]



 17%|███████████████████▏                                                                                             | 369/2170 [03:43<16:26,  1.83it/s]



 17%|███████████████████▋                                                                                             | 379/2170 [03:49<16:50,  1.77it/s]


 18%|████████████████████▏                                                                                            | 387/2170 [03:53<16:08,  1.84it/s]



 18%|████████████████████▋                                                                                            | 398/2170 [03:59<16:11,  1.82it/s]
 18%|████████████████████▊                                                                                            | 400/2170 [04:00<16:05,  1.83it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████▊                                 | 20/28 [00:00<00:00, 21.72it/s]



 19%|█████████████████████▎                                                                                           | 410/2170 [04:07<16:46,  1.75it/s]


 19%|█████████████████████▋                                                                                           | 417/2170 [04:11<16:33,  1.77it/s]



 20%|██████████████████████▎                                                                                          | 428/2170 [04:17<16:09,  1.80it/s]



 20%|██████████████████████▊                                                                                          | 438/2170 [04:23<16:33,  1.74it/s]



 21%|███████████████████████▍                                                                                         | 449/2170 [04:29<16:14,  1.77it/s]



 21%|███████████████████████▊                                                                                         | 458/2170 [04:35<18:43,  1.52it/s]




 22%|████████████████████████▍                                                                                        | 470/2170 [04:43<18:28,  1.53it/s]



 22%|████████████████████████▉                                                                                        | 480/2170 [04:49<16:34,  1.70it/s]


 22%|█████████████████████████▎                                                                                       | 487/2170 [04:53<15:53,  1.77it/s]



 23%|█████████████████████████▉                                                                                       | 498/2170 [05:00<16:04,  1.73it/s]
 23%|██████████████████████████                                                                                       | 500/2170 [05:01<15:58,  1.74it/s]
 64%|██████████████████████████████████████████████████████████████████████████▌                                         | 18/28 [00:00<00:00, 22.31it/s]



 23%|██████████████████████████▌                                                                                      | 509/2170 [05:08<18:29,  1.50it/s]



 24%|██████████████████████████▉                                                                                      | 518/2170 [05:14<18:05,  1.52it/s]




 24%|███████████████████████████▌                                                                                     | 530/2170 [05:21<17:47,  1.54it/s]


 25%|███████████████████████████▉                                                                                     | 537/2170 [05:25<15:23,  1.77it/s]



 25%|████████████████████████████▌                                                                                    | 548/2170 [05:31<15:14,  1.77it/s]




 26%|█████████████████████████████▏                                                                                   | 560/2170 [05:39<17:38,  1.52it/s]



 26%|█████████████████████████████▋                                                                                   | 570/2170 [05:46<17:06,  1.56it/s]



 27%|██████████████████████████████▏                                                                                  | 579/2170 [05:52<17:01,  1.56it/s]




 27%|██████████████████████████████▋                                                                                  | 590/2170 [05:59<17:57,  1.47it/s]



 28%|███████████████████████████████▏                                                                                 | 599/2170 [06:05<17:13,  1.52it/s]

 28%|███████████████████████████████▏                                                                                 | 600/2170 [06:08<17:10,  1.52it/s]



 28%|███████████████████████████████▋                                                                                 | 609/2170 [06:13<17:38,  1.47it/s]



 28%|████████████████████████████████▏                                                                                | 618/2170 [06:19<16:46,  1.54it/s]



 29%|████████████████████████████████▊                                                                                | 629/2170 [06:26<14:36,  1.76it/s]



 29%|█████████████████████████████████▎                                                                               | 640/2170 [06:32<14:11,  1.80it/s]



 30%|█████████████████████████████████▉                                                                               | 651/2170 [06:38<13:45,  1.84it/s]


 30%|██████████████████████████████████▎                                                                              | 658/2170 [06:42<13:59,  1.80it/s]




 31%|██████████████████████████████████▉                                                                              | 671/2170 [06:50<15:14,  1.64it/s]



 31%|███████████████████████████████████▎                                                                             | 679/2170 [06:55<17:04,  1.46it/s]



 32%|███████████████████████████████████▊                                                                             | 688/2170 [07:01<16:10,  1.53it/s]



 32%|████████████████████████████████████▎                                                                            | 698/2170 [07:07<16:14,  1.51it/s]
 32%|████████████████████████████████████▍                                                                            | 700/2170 [07:09<16:19,  1.50it/s]
 57%|██████████████████████████████████████████████████████████████████▎                                                 | 16/28 [00:00<00:00, 21.24it/s]



 33%|████████████████████████████████████▊                                                                            | 708/2170 [07:15<17:03,  1.43it/s]



 33%|█████████████████████████████████████▎                                                                           | 717/2170 [07:21<15:40,  1.54it/s]




 34%|█████████████████████████████████████▉                                                                           | 729/2170 [07:29<15:40,  1.53it/s]



 34%|██████████████████████████████████████▍                                                                          | 739/2170 [07:36<15:41,  1.52it/s]



 35%|███████████████████████████████████████                                                                          | 749/2170 [07:41<13:15,  1.79it/s]



 35%|███████████████████████████████████████▌                                                                         | 759/2170 [07:47<14:47,  1.59it/s]



 35%|███████████████████████████████████████▉                                                                         | 768/2170 [07:53<15:20,  1.52it/s]



 36%|████████████████████████████████████████▌                                                                        | 778/2170 [08:00<15:06,  1.54it/s]



 36%|████████████████████████████████████████▉                                                                        | 787/2170 [08:05<13:46,  1.67it/s]



 37%|█████████████████████████████████████████▌                                                                       | 798/2170 [08:12<13:31,  1.69it/s]
 37%|█████████████████████████████████████████▋                                                                       | 800/2170 [08:13<13:44,  1.66it/s]
 39%|█████████████████████████████████████████████▌                                                                      | 11/28 [00:00<00:01, 14.91it/s]



 37%|██████████████████████████████████████████                                                                       | 808/2170 [08:19<13:40,  1.66it/s]



 38%|██████████████████████████████████████████▋                                                                      | 819/2170 [08:26<12:41,  1.77it/s]



 38%|███████████████████████████████████████████▏                                                                     | 830/2170 [08:32<12:36,  1.77it/s]



 39%|███████████████████████████████████████████▋                                                                     | 840/2170 [08:38<12:28,  1.78it/s]


 39%|████████████████████████████████████████████                                                                     | 847/2170 [08:41<12:22,  1.78it/s]



 40%|████████████████████████████████████████████▋                                                                    | 858/2170 [08:48<12:22,  1.77it/s]



 40%|█████████████████████████████████████████████▎                                                                   | 869/2170 [08:54<12:04,  1.80it/s]



 41%|█████████████████████████████████████████████▊                                                                   | 880/2170 [09:00<12:02,  1.78it/s]



 41%|██████████████████████████████████████████████▎                                                                  | 890/2170 [09:06<12:09,  1.76it/s]


 41%|██████████████████████████████████████████████▋                                                                  | 897/2170 [09:10<12:05,  1.76it/s]
 41%|██████████████████████████████████████████████▊                                                                  | 900/2170 [09:11<11:56,  1.77it/s]
 64%|██████████████████████████████████████████████████████████████████████████▌                                         | 18/28 [00:00<00:00, 26.82it/s]



 42%|███████████████████████████████████████████████▎                                                                 | 908/2170 [09:18<14:09,  1.49it/s]



 42%|███████████████████████████████████████████████▊                                                                 | 918/2170 [09:24<12:13,  1.71it/s]



 43%|████████████████████████████████████████████████▍                                                                | 929/2170 [09:30<11:40,  1.77it/s]



 43%|████████████████████████████████████████████████▉                                                                | 939/2170 [09:36<12:13,  1.68it/s]



 44%|█████████████████████████████████████████████████▎                                                               | 948/2170 [09:42<13:03,  1.56it/s]




 44%|█████████████████████████████████████████████████▉                                                               | 959/2170 [09:49<16:36,  1.22it/s]




 45%|██████████████████████████████████████████████████▌                                                              | 970/2170 [09:58<12:35,  1.59it/s]



 45%|███████████████████████████████████████████████████                                                              | 981/2170 [10:04<11:00,  1.80it/s]


 46%|███████████████████████████████████████████████████▍                                                             | 988/2170 [10:08<11:01,  1.79it/s]



 46%|████████████████████████████████████████████████████                                                             | 999/2170 [10:14<10:48,  1.80it/s]
 46%|███████████████████████████████████████████████████▌                                                            | 1000/2170 [10:16<10:52,  1.79it/s]Traceback (most recent call last):
  File "/workspace/rtp/CF-PepMLM/train.py", line 55, in <module>
    trainer.train()
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 1932, in train
    return inner_training_loop(
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 2345, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 2796, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial, metrics=metrics)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 2875, in _save_checkpoint
    self.save_model(output_dir, _internal_call=True)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3429, in save_model
    self._save(output_dir)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3494, in _save
    safetensors.torch.save_file(
  File "/usr/local/lib/python3.10/dist-packages/safetensors/torch.py", line 284, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
  File "/usr/local/lib/python3.10/dist-packages/safetensors/torch.py", line 480, in _flatten
    raise RuntimeError(
RuntimeError:
            Some tensors share memory, this will lead to duplicate memory on disk and potential differences when loading them again: [{'base_model.roberta.embeddings.word_embeddings.weight', 'base_model.lm_head.decoder.weight'}, {'base_model.lm_head.bias', 'base_model.lm_head.decoder.bias'}].
            A potential way to correctly save your model is to use `save_model`.
            More information at https://huggingface.co/docs/safetensors/torch_shared_tensors
{'eval_loss': 0.0003016693517565727, 'eval_runtime': 1.028, 'eval_samples_per_second': 212.062, 'eval_steps_per_second': 27.237, 'epoch': 4.61}